# misc/cookie
4 solves / 485 points

>Author: hellopir2
>
>What is life if not incomprehensible nonsense? Please untangle this for me. I'm hungry.
>
>Flag is valid ascii.

Attached files: [checker.py](./checker.py), [out.zip](./out.zip)

## Challenge outline
First, I took a look at the extracted out.txt file from out.zip:
```
8638/12964/g0g0g0g0g0g0g0g0g0g0g0g0g0g0g0g0g0g0g0g0g0g0....
```
It seems as though we have two numbers at the start separated by slashes, followed by the string `g0` repeated a large number of times. Looking at a bit more of the text, we also start to see the strings `;3` and `^0`. On its own, this isn't very helpful, so let's take a look at the checker.py script:
```python
server_map = open('out.txt').read()
player_map = open('player.txt').read()
w, l, server_map = server_map.split("/")
w2, l2, player_map = player_map.split("/")
assert w == w2 and l == l2 and len(server_map) == len(player_map)
w, l = int(w), int(l)

grid = [[] for i in range(l)]
for i in range(len(server_map)//2):
    idx = slice(2*i, 2*i+2)
    server, player = server_map[idx], player_map[idx]
    if server == "^0":
        assert player_map[2*i:2*i+2] in [";3", "$0"]
    else:
        assert player == server
    grid[i//w].append(player)

def neighs(r,c):
    return sum(grid[r-1+i//3][c-1+i%3] == "$0" for i in range(9))

qq = {"$0": "S", ";3": " ", "g0": "."}

for i in range(l):
    for j in range(w):
        if grid[i][j] == ";3" and neighs(i,j) == 1:
            grid[i][j] = "$0"

if grid[-4][-4] == "$0":
    bitstring = ""
    for i in range(len(server_map)//2): # shut up i know it's inefficient, deal with it.
        idx = slice(2*i, 2*i+2)
        if server_map[idx] == "^0":
            bitstring += str([";3", "$0"].index(player_map[idx]))
    print("Correct! Your flag is amateursCTF{" + bytes.fromhex(hex(int(bitstring, 2))[2:]).decode() + "}")
```
The script seems to be pretty straight forward. Here's a brief rundown of what it does:

1. Reads out.txt into the server map and player.txt into the player map.
2. Turns the player string into a grid using the two numbers we saw above as dimensions, making sure the player and server maps are the same size. Each element of the grid is two characters, and from here on out I'll call each pair of characters a cell for convenience.
3. For every occurrence of the cell `^0` in the server map, it makes sure the corresponding cell in the player map is either `;3` or `$0`. After viewing the text file, we can see these cells are equally spaced throughout the 4th row. Setting these values serves as the user's input.
4. From here, the script runs through the grid top-to-bottom, left-to-right. If the cell in a given position is `;3` and it has *exactly* one `$0` cell neighboring it, it will turn into a `$0` itself. 
5. If the cell at position [-4][-4] in the matrix is a `$0`, that means the user has the correct input for the flag.
6. If this condition is met, the program will go back to the locations of the `^0` cells in the server map (i.e. the user input). It will translate a `;3` in that location in the player map into a 0, and a `$0` in that location to a 1. These are then put together in a binary string, which is then converted to the flag text

*Note: making and editing my own player.txt file seemed tedious, so I simply the player map equal to the server map, adding in the input values later on from a settings file. See my [modified checker script](./modified.py) for more detail!*

## Solve process
Alright, let's get started with the solve!

### Visualization + Info gathering


I personally had a bit of trouble imagining what this would look like just from the code, so let's visualize it!
By adding the line `input(grid[i][:45])` to the loop which checks for the neighbors of each cell in the grid, we can print the start of each row of the grid, one row at a time.
```python
for i in range(l):
    for j in range(w):
        if grid[i][j] == ";3" and neighs(i,j) == 1:
            grid[i][j] = "$0"
        input(grid[i][:45])
```
From the output of some random start values, we can see an interesting structure present:
```
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']l
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', ';3', ';3', ';3', ';3', ';3', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', ';3', ';3', ';3', '$0', ';3', '$0', '$0', '$0', '$0', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '$0', '$0', '$0', '$0', '$0', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '$0', '$0', '$0', '$0', '$0', '$0', '$0', '$0', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '$0', '$0', '$0', ';3', '$0', ';3', ';3', ';3', ';3', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '$0', '$0', '$0', '$0']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', ';3', ';3', ';3', ';3', ';3', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', ';3', ';3', ';3', ';3', ';3', ';3', ';3', ';3', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', ';3', ';3', ';3', '$0', ';3', '$0', '$0', '$0', '$0', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '$0', '$0', '$0', ';3']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ']
```
*Note: In my solve, all `g0` cells were replaced with double spaces using `.replace('g0', '  ')` after the text was loaded to improve visibility*

Each input value initializes a 'gate' (the column-like structures), which is made of the input cell and retains this value traveling downward. On the left, rows of `;3`'s and `$0`'s seem to be starting values which will pass through each gate. Upon further analysis, there seems to be 616 starting values, meaning there will be 616 outputs on the right side. Finally, between each gate, 'bit flippers' seem to be placed randomly, which either turn a path of `;3`'s into `$0`'s or vice versa. 

With all the information from the left side of the grid, we can change `grid[i][:45]` to `grid[i][-45:]` in order to see the right side of the grid:
```
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', ';3', ';3', ';3', ';3', ';3', ';3', ';3', ';3', ';3', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', ';3', ';3', ';3', '$0', ';3', '$0', '$0', '$0', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ']
['  ', '  ', '$0', '$0', '$0', '$0', '$0', '$0', '$0', '$0', '$0', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '$0', '$0', '$0', '$0', '$0', '$0', '$0', '$0', '$0', '$0', '$0', '  ', '  ', '  ', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '$0', '$0', '$0', ';3', '$0', ';3', ';3', ';3', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
['  ', '  ', ';3', ';3', ';3', '$0', ';3', '$0', '$0', '$0', '$0', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '$0', '$0', '$0', '$0', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '$0', '$0', '$0', ';3', '$0', ';3', ';3', ';3', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '$0', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '$0', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ']
['  ', '  ', ';3', ';3', ';3', ';3', ';3', ';3', ';3', ';3', ';3', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '$0', '$0', '$0', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', ';3', ';3', ';3', ';3', ';3', ';3', ';3', ';3', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '$0', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ']
['$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ']
['$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '$0', '  ']
['  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ']
['  ', '  ', '$0', '$0', '$0', ';3', '$0', ';3', ';3', ';3', ';3', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '$0', '$0', '$0', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', ';3', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '  ', '$0', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ', ';3', ';3', ';3', '$0', ';3', '$0', '$0', '$0', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '  ', '  ', '$0', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ']
['  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', ';3', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ']
['$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ']
['$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '$0', '  ']
['  ', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', ';3', '  ', '  ']
['  ', '  ', '$0', '$0', '$0', ';3', '$0', ';3', ';3', ';3', ';3', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '$0', '$0', '$0', '$0', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ']
[';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', ';3', '  ', '  ', '  ', ';3', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ']
```
The hexagonal flower-looking structure we see on the far right continues repeating down the side of the board until it reaches the cell at [-4][-4]. We can see that in order for one of them to pass down a `$0` cell, both its upper-left and upper-right inputs must be `$0` cells.  Because each of these inputs comes directly from the 616 outputs of the gate field, we know that we must find a specific combination of gates which will result in all `$0` outputs from the gate field.

But how exactly do these gates influence their input? I was a bit confused about this at first; when I activated a gate by setting its input value to `$0`, it seemed to flip some of its inputs, but it seemed to keep some of them the same. However, after looking closer, I noticed that for some rows in each gate, the gate 'touched' the input when it entered, and the output was flipped as a result:
```
'  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  '
'  ',  touches -------> '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  '
';3', ';3', ';3', '$0', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  '
'  ',   ↑   '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  '
'  ',   |   '  ', '  ', '  ', '$0', '  ', '$0', '  ', '              ', '  '
'       |      ', '  ', '$0', '  ', ';3', '  ', '$0', '    ends $0   ', '  '
'   starts ;3  ', '  ', '  ', '$0', '  ', '$0', '  ', '       |      ', '  '
'              ', '  ', '$0', '  ', '  ', '$0', '  ', '  ',   |   '  ', '  '
'  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ',   ↓   '  ', '  '
'  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', '$0', '$0', '$0', '$0'
'  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  '
```
Whereas for other rows, the gate did *not* touch the input when it entered, and therefore the output was *not* flipped:
```
'  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  '
 doesn't touch -------> '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  '
';3', ';3', ';3', ';3', '  ', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  '
'  ',   ↑   '  ', '  ', ';3', '  ', '  ', '  ', '$0', '  ', '  ', '  ', '  '
'  ',   |   '  ', '  ', '  ', ';3', '  ', '$0', '  ', '              ', '  '
'       |      ', '  ', ';3', '  ', '$0', '  ', '$0', '    ends ;3   ', '  '
'   starts ;3  ', '  ', '  ', '$0', '  ', ';3', '  ', '       |      ', '  '
'              ', '  ', '$0', '  ', '  ', ';3', '  ', '  ',   |   '  ', '  '
'  ', '  ', '  ', '  ', '  ', '$0', '  ', '  ', ';3', '  ',   ↓   '  ', '  '
'  ', '  ', '  ', '  ', '$0', '  ', '$0', '  ', '  ', ';3', ';3', ';3', ';3'
'  ', '  ', '  ', '  ', '$0', '  ', '  ', '$0', '  ', '  ', '  ', '  ', '  '
```
As such, if we know the order in which a gate has these flipping/non-flipping mechanisms, we can turn it into a binary string, where a 0 would represent no flip, and a 1 would represent a flipper. This allows us to simplify the rules of the inputs, outputs, neighbors, etc. to just an XOR operation; if a gate has a 1 in a given location, it'll flip the input's value, and if it has a 0, it will do nothing. From there, we can treat the inputs in a similar manner; a `;3` will represent a 0, and a `$0` will represent a 1. Take any input as a binary string, and we can get the output of the gate by performing an XOR on the input with the gate value.

Using the following addition to the checker script after the grid is constructed, we can run through each of the 616 gates, and check each of the gate's 616 input locations for whether or not there is a cell present, writing the values to a text file for future use:
```python
with open('gatevalues.txt', 'w') as gates:
    for gate in range(616):
        for i in range(616):
            gates.write(str(["  ", ";3"].index(grid[14*i + 16 + gate*7][14 * gate + 8])))
        gates.write("\n")
```
In a similar manner, we can get the 'default' output (i.e. the output with none of the gates active) of the rows by checking the ends after all the transformations/flips have completed. The reason it's not simply the starting input is because of the random flippers between the gates, but since we know the operation comes down to an XOR, the exact locations of those bitflips are irrelevant. Once we have the default value, we simply need to find the combination of gates which will find the 'inverse' of the default (the default value with all the digits flipped), as adding the default with the inverse will let us get all 1's at the end:
```python
with open('default.txt', 'w') as default:
    default.write("1") #The first row's output is formatted differently and doesn't align with the rest, so I manually added the correct default output
    for i in range(615):
        default.write(str([";3", "$0"].index(grid[4344 + 14*i][-11])))
```
### Solved...?

Great! Now that we have the default output, and we know we can find the output of activating any gate by simply applying an XOR, we should just be able to bruteforce which gates need to be active to make the end a series of 1's, right?

Well, unfortunately that's not the case. Let's do a bit of quick math: We have 616 gates, each having 2 possibilities: on or off. That brings us to 2^616 different combinations of gates, or roughly *2.72 \* 10^185 possibilities.* That's way too many to bruteforce. 

The challenge tells us that the flag is valid ascii, maybe we could use that? Let's do a bit more math. The flag will be 616 bits, meaning 77 characters (616/8). There's 96 (visible) ascii characters, meaning each character has 96 possibilities. 96^77 gets us to 4.31 * 10^152 possibilities. That's orders of magnitude better than before, but is still far to much to bruteforce. So what can we do?

### Systems of equations and finite fields

Let's think about this a little bit differently. The end result for each row is simply a sum of the past activated gates, so let's think of each row as an equation, which we want 1 to be the solution of. Then let's imagine the activation  of each gate to be an unknown variable which we want to know the value of. Our coefficients for these variables in a given row are the 'states' of the gates at each location in the row (i.e. whether the gate is 'connected' or not). If our activation states for each gate are considered to be $g_0$, $g_1$, ..., $g_{615}$, our connection states in those gates for a given row (which we know because we extracted them earlier) are $c_0$, $c_1$, ..., $c_{615}$, and our intended value is $d$, we can set up an equation equal to the value we want.

From this, we get the equation:
$$g_0c_0 + g_1c_1 + ... + g_{615}c_{615} = d$$
in which we know the $c$ values. Since we have exactly 616 rows, we will end up with 616 different equations. And with 616 equations and 616 unknowns, we can set up a system of equations to solve for the unknowns.

Now the question is, how do we simulate the XOR operation within the system of equations? Well, this is where a handy little trick I learned in picoCTF 2024 a few weeks ago comes in: by using a [finite field](https://en.wikipedia.org/wiki/Finite_field) (also called a galois field) based on a prime number (in this case 2) while solving the system, we can ensure that every operation in the solve is done modulo 2. And as it turns out, addition modulo 2 is equivalent to the XOR operation!

### Finally, the solve

We can finally put this information together into a solve script. I'm using numpy's linalg.solve function to automatically find the solutions of the equation, and I'm using GF from the galois module to ensure the operations and answers are modulo 2:

```python
import numpy as np
import galois

GF = galois.GF(2)

with open('gatevalues.txt', 'r') as file:
    binary_values = [line.strip() for line in file]

matrix = np.array([[GF(int(binary_values[element][row])) for element in range(616)] for row in range(616)]) #setting up equation matrix

### MATRIX INITIALIZED ###

with open('default.txt', 'r') as goal:
    default = goal.read()
    intended = default.replace("1", "a").replace("0", "1").replace("a", "0")

solutions = np.array([GF(int(char)) for char in intended])

solved_matrix = np.linalg.solve(GF(matrix), GF(solutions))

flagtext = bytes.fromhex(str(hex(int("".join(str(row) for row in solved_matrix),2)))[2:]).decode()

print("FLAG: amateursCTF{" + flagtext + "}")
```
Unfortunately, we're not quite out of the woods yet. When attempting to run this script, we get the error:
```
numpy.linalg.LinAlgError: Argument 'A' is singular and not invertible because it does not have full rank of 616, but rank of 615.
```
What this means is that, somewhere in the  created matrix, one of the columns is the result of adding some combination of the other columns, which messes up numpy's solve. Luckily, however, after some testing I disovered that one of the problematic columns is the very first one. If we know the flag is valid ascii, we know for sure that the first column must be inactive, as no ascii character has a 1 in the first position when converted to binary. What we can do then is remove the first column to get rid of the initial problem (which will have no impact on the solution because we know it's inactive), we can remove the first row in order to make the matrix square again (which is required by numpy), and we can remove the first digit in the solutions matrix (because we just removed the first equation). 

The updated [solve script](./solve.py) looks like this:
```python
import numpy as np
import galois

GF = galois.GF(2)

with open('gatevalues.txt', 'r') as file:
    binary_values = [line.strip() for line in file]

initialmatrix = [[GF(int(binary_values[element][row])) for element in range(616)] for row in range(616)]
col_removed = [row[1:] for row in initialmatrix]
row_removed = col_removed[1:]
matrix = np.array(row_removed)

### MATRIX INITIALIZED ###

with open('default.txt', 'r') as goal:
    default = goal.read()
    intended = default.replace("1", "a").replace("0", "1").replace("a", "0")
    intended = intended[1:]

solutions = np.array([GF(int(char)) for char in intended])

solved_matrix = np.linalg.solve(GF(matrix), GF(solutions))


flagtext = bytes.fromhex(str(hex(int("".join(str(row) for row in solved_matrix),2)))[2:]).decode()

print("FLAG: amateursCTF{" + flagtext + "}")
```

And finally, we get the flag!  
```
FLAG: amateursCTF{5hR13kbu1bS_Ar3_Th3_B3s7_b3c4uS3_th3y_a110W_m3_t0_c0n5trUcT_CircU1ts_68bbf319}
```



## Flag
```
amateursCTF{5hR13kbu1bS_Ar3_Th3_B3s7_b3c4uS3_th3y_a110W_m3_t0_c0n5trUcT_CircU1ts_68bbf319}
```

<p align="center">
  <img src="./shriekbulb.png" /><br>
  <br><i>An image of a Shriekbulb from the garden in the game Cookie Clicker, the plant this challenge is based off of.</i>
  <br><i>Like this program, the Shriekbulb will spread to another spot in the Garden if and only if there is exactly one Shriekbulb neighboring the spot.</i>
  <br><i>Coincidentally, the Shriekbulb also looks extremely similar to how I did trying to figure out how to solve this challenge :)</i>
</p>